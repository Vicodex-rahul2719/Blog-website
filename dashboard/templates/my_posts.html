{% extends 'base/base.html' %}
{% block content %}
  <style>
    body { color: #333; }

    /* Sidebar Glass Effect */
    .sidebar {
      min-height: 100%;
      background: rgba(25, 25, 35, 0.95);
      padding: 20px;
      border-radius: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.25);
    }
    .menu-card {
      display: flex;
      align-items: center;
      padding: 12px 15px;
      margin-bottom: 12px;
      border-radius: 12px;
      color: #fff;
      text-decoration: none;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    .menu-card i { margin-right: 10px; }
    .menu-card:hover {
      background: linear-gradient(135deg, #4e73df, #1cc88a);
      transform: translateX(5px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    .bg-gradient-blue { background: linear-gradient(135deg, #4e54c8, #8f94fb); }
    .bg-gradient-green { background: linear-gradient(135deg, #11998e, #38ef7d); }
    .bg-gradient-orange { background: linear-gradient(135deg, #ff9966, #ff5e62); }
    /* .menu-card i { margin-right: 7px; font-size: 1.2rem; }
    .menu-card:hover { background: rgba(255, 255, 255, 0.1); color: #fff; border-radius: 8px; } */

    /* My posts */
    .card {
      border: none;
      border-radius: 20px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    .card-img-top {
      border-radius: 20px 20px 0 0;
      height: 200px;
      object-fit: cover;
    }
    .card-body {
      display: flex;
      flex-direction: column;
      flex-grow: 1;
    }
    .card-title a:hover {
      text-decoration: underline;
      color: #0072ff;
    }

    /* Buttons */
    .btn-edit {
      background: linear-gradient(45deg, #1d976c, #93f9b9);
      color: white;
      font-weight: 600;
    }
    .btn-delete {
      background: linear-gradient(45deg, #ff416c, #ff4b2b);
      color: white;
      font-weight: 600;
    }
    .btn-read {
      background: linear-gradient(45deg, #0072ff, #00c6ff);
      color: white;
      font-weight: 600;
    }
    .btn-edit:hover,
    .btn-delete:hover,
    .btn-read:hover {
      opacity: 0.9;
    }
    .btn-sm {
      padding: 3px 8px;
      font-size: 0.8rem;
    }

    /* Post meta */
    .post-meta {
      font-size: 0.85rem;
      color: #6c757d;
    }
    .badge-category {
      background: linear-gradient(45deg, #0072ff, #00c6ff);
      font-size: 0.75rem;
    }

    /* Mobile adjustments */
    @media (max-width: 992px) {
      .sidebar {
        min-height: auto;
        margin-bottom: 5px;
      }
    }
  </style>
   {% for message in messages %}
    <div
      class=" alertdiv alert alert-{{ message.tags }} alert-dismissible fade show"
      role="alert"
    >
      <strong>Alert !</strong> {{message}}
      <button
        type="button"
        class="close"
        data-dismiss="alert"
        aria-label="Close"
        id="close"
      >
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    {% endfor %}

    <script>
      document.querySelector("#close").addEventListener("click", function () {
        document.querySelector(".alertdiv").style.display = "none";
      });
    </script>
  <div class="container-fluid py-2 mt-0">
    <div class="row g-3">
      
      <!-- Sidebar Menu -->
      {% include 'leftsidebar.html' %}

      <!-- Main Content -->
      <div class="col-lg-9 ml-1">
        <div class="container">
          
          <!-- Heading -->
          <div class="container heading-middle d-flex justify-content-between align-items-center rounded px-3 mb-3 mt-2"
               style="background-color: rgba(24, 9, 54, 1);">
            <h2 class="text-warning mb-0"><b>MY POSTS</b></h2>
            <a href="{% url 'my_post_all' %}" class="text-decoration-none">
              <h5 class="mb-0" style="color: #00c6ff;"><b>View All ‚Üí</b></h5>
            </a>
          </div>

          <!-- Posts -->
          <div class="row g-4">
            {% if posts %}
           {% for i in posts %}
  <div class="col-md-6 col-lg-4">
    <div class="card h-100">
      <img src="/media/{{ i.blog_image }}" class="card-img-top" alt="Post Image">

      <div class="card-body d-flex flex-column">

        <!-- Title -->
        <h5 class="card-title fw-bold">
          <a href="{% url 'blogs' i.slug %}" class="text-dark text-decoration-none">
            {{ i.title }}
          </a>
        </h5>

        <!-- Description -->
        <p class="card-text mb-2">
          {{ i.short_description | truncatewords:20 }}
        </p>

        <!-- Post Meta -->
        <p class="post-meta mb-2">
          üë§ {{ i.author.get_full_name }} &nbsp;|&nbsp; üìÖ {{ i.created_at|timesince }} ago
          <a href="#" class="badge badge-category ms-2 text-decoration-none">#Blogger</a>
        </p>

        <!-- Like / Dislike / Comment -->
        <div class="d-flex gap-2 align-items-center mb-3">
          <form method="post" action="{% url 'like_blog' i.id %}" style="display:inline;">{% csrf_token %}
            <button type="submit" 
                        class="btn btn-sm {% if user in i.liked_users.all %}btn-success{% else %}btn-outline-success{% endif %}">
                  üëç {{ i.liked_users.count }}
                </button>
          </form>
          <form method="post" action="{% url 'dislike_blog' i.id %}" style="display:inline;">{% csrf_token %}
            <button type="submit" 
                        class="btn btn-sm {% if user in i.disliked_users.all %}btn-danger{% else %}btn-outline-danger{% endif %}">
                  üëé {{ i.disliked_users.count }}
                </button>
          </form>
          <a href="{% url 'blogs' i.slug %}" class="text-muted" style="font-size: 0.9rem;">üí¨ {{ i.comment_count }}</a>
        </div>

        <!-- Footer Buttons -->
        <div class="d-flex justify-content-between mt-auto">
          <div>
            <a href="{% url 'update_blog' i.id %}" class="btn btn-edit btn-sm">‚úèÔ∏è Edit</a>
            <a href="{% url 'delete_blog' i.id %}" class="btn btn-delete btn-sm">üóëÔ∏è Delete</a>
          </div>
          <a href="{% url 'blogs' i.slug %}" class="btn btn-read btn-sm">üëÅÔ∏è</a>
        </div>

      </div>
    </div>
  </div>
   
{% endfor %}
{% else %}
  <div class="col-12 text-center py-5">
    <h4 class="text-muted">üòî You haven't posted anything yet.</h4>
    <a href="{% url 'add_blog' %}" class="btn btn-primary mt-3">‚ûï Create your first post</a>
  </div>
{% endif %}

          </div> <!-- row -->

        </div> <!-- container -->
      </div> <!-- main content -->

    </div> <!-- row -->
  </div> <!-- container-fluid -->

{% endblock %}